<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TaskFlow - Task Management</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #3b82f6;
            --secondary-color: #8b5cf6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --background-color: #f8fafc;
            --surface-color: #ffffff;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --border-color: #e5e7eb;
            --shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        [data-theme="dark"] {
            --background-color: #0f172a;
            --surface-color: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #94a3b8;
            --border-color: #334155;
            --shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.3);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--background-color);
            color: var(--text-primary);
            line-height: 1.6;
            transition: background-color 0.3s ease;
        }

        .header {
            background: var(--surface-color);
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border-color);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .header-actions {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 0.375rem;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-secondary {
            background: var(--surface-color);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--background-color);
        }

        .theme-toggle {
            background: none;
            border: none;
            color: var(--text-primary);
            cursor: pointer;
            padding: 0.5rem;
            border-radius: 0.375rem;
            transition: background-color 0.2s ease;
        }

        .theme-toggle:hover {
            background: var(--background-color);
        }

        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        .nav-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 2px solid var(--border-color);
        }

        .nav-tab {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
        }

        .nav-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }

        .nav-tab:hover {
            color: var(--text-primary);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .board-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .column {
            background: var(--surface-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            min-height: 400px;
        }

        .column-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--border-color);
        }

        .column-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .task-count {
            background: var(--background-color);
            color: var(--text-secondary);
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .tasks-container {
            min-height: 300px;
            transition: background-color 0.2s ease;
        }

        .tasks-container.drag-over {
            background: var(--background-color);
            border-radius: 0.5rem;
        }

        .task {
            background: var(--surface-color);
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            padding: 1rem;
            margin-bottom: 0.75rem;
            cursor: move;
            box-shadow: var(--shadow);
            transition: all 0.2s ease;
        }

        .task:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-1px);
        }

        .task.dragging {
            opacity: 0.5;
            transform: rotate(2deg);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .task-title {
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.25rem;
        }

        .task-description {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-bottom: 0.75rem;
        }

        .task-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.75rem;
            color: var(--text-secondary);
        }

        .task-priority {
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-weight: 500;
            font-size: 0.625rem;
            text-transform: uppercase;
        }

        .priority-high {
            background: #fef2f2;
            color: var(--danger-color);
        }

        .priority-medium {
            background: #fefbf2;
            color: var(--warning-color);
        }

        .priority-low {
            background: #f0fdf4;
            color: var(--success-color);
        }

        .task-actions {
            display: flex;
            gap: 0.5rem;
        }

        .task-action {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            padding: 0.25rem;
            border-radius: 0.25rem;
            transition: all 0.2s ease;
        }

        .task-action:hover {
            color: var(--text-primary);
            background: var(--background-color);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: var(--surface-color);
            border-radius: 0.75rem;
            padding: 2rem;
            width: 90%;
            max-width: 500px;
            box-shadow: var(--shadow-lg);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .modal-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--text-secondary);
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            background: var(--surface-color);
            color: var(--text-primary);
            font-size: 0.875rem;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            background: var(--surface-color);
            color: var(--text-primary);
            font-size: 0.875rem;
        }

        .form-textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            background: var(--surface-color);
            color: var(--text-primary);
            font-size: 0.875rem;
            min-height: 100px;
            resize: vertical;
        }

        .form-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
            margin-top: 1.5rem;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .dashboard-card {
            background: var(--surface-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
            box-shadow: var(--shadow);
        }

        .dashboard-card h3 {
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .chart-container {
            width: 100%;
            height: 300px;
            position: relative;
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--surface-color);
            border-radius: 0.75rem;
            padding: 1.5rem;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
        }

        .stat-label {
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: 0.5rem;
        }

        .user-switch {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            margin-bottom: 1rem;
        }

        .current-user {
            background: var(--primary-color);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 0.375rem;
            font-weight: 500;
        }

        .filters {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
            flex-wrap: wrap;
        }

        .filter-select {
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 0.375rem;
            background: var(--surface-color);
            color: var(--text-primary);
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
            }

            .main-content {
                padding: 1rem;
            }

            .board-container {
                grid-template-columns: 1fr;
            }

            .nav-tabs {
                flex-wrap: wrap;
            }

            .filters {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">TaskFlow</div>
            <div class="header-actions">
                <button class="btn btn-primary" onclick="openTaskModal()">+ Add Task</button>
                <button class="theme-toggle" onclick="toggleTheme()">🌙</button>
            </div>
        </div>
    </header>

    <main class="main-content">
        <nav class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('board')">Board</button>
            <button class="nav-tab" onclick="switchTab('dashboard')">Dashboard</button>
        </nav>

        <div id="board-tab" class="tab-content active">
            <div class="user-switch">
                <span>Current User:</span>
                <span class="current-user" id="current-user">John Doe</span>
                <button class="btn btn-secondary" onclick="switchUser()">Switch User</button>
            </div>

            <div class="filters">
                <select class="filter-select" id="user-filter" onchange="filterTasks()">
                    <option value="">All Users</option>
                    <option value="John Doe">John Doe</option>
                    <option value="Jane Smith">Jane Smith</option>
                    <option value="Mike Johnson">Mike Johnson</option>
                </select>
                <select class="filter-select" id="priority-filter" onchange="filterTasks()">
                    <option value="">All Priorities</option>
                    <option value="high">High</option>
                    <option value="medium">Medium</option>
                    <option value="low">Low</option>
                </select>
            </div>

            <div class="board-container">
                <div class="column" data-status="todo">
                    <div class="column-header">
                        <h3 class="column-title">To Do</h3>
                        <span class="task-count" id="todo-count">0</span>
                    </div>
                    <div class="tasks-container" id="todo-tasks"></div>
                </div>

                <div class="column" data-status="inprogress">
                    <div class="column-header">
                        <h3 class="column-title">In Progress</h3>
                        <span class="task-count" id="inprogress-count">0</span>
                    </div>
                    <div class="tasks-container" id="inprogress-tasks"></div>
                </div>

                <div class="column" data-status="done">
                    <div class="column-header">
                        <h3 class="column-title">Done</h3>
                        <span class="task-count" id="done-count">0</span>
                    </div>
                    <div class="tasks-container" id="done-tasks"></div>
                </div>
            </div>
        </div>

        <div id="dashboard-tab" class="tab-content">
            <div class="stat-grid">
                <div class="stat-card">
                    <div class="stat-value" id="total-tasks">0</div>
                    <div class="stat-label">Total Tasks</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="completed-tasks">0</div>
                    <div class="stat-label">Completed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="in-progress-tasks">0</div>
                    <div class="stat-label">In Progress</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="completion-rate">0%</div>
                    <div class="stat-label">Completion Rate</div>
                </div>
            </div>

            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Task Distribution</h3>
                    <div class="chart-container">
                        <canvas id="task-chart" width="400" height="300"></canvas>
                    </div>
                </div>
                <div class="dashboard-card">
                    <h3>Tasks by User</h3>
                    <div class="chart-container">
                        <canvas id="user-chart" width="400" height="300"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <div class="modal" id="task-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-title">Add New Task</h3>
                <button class="modal-close" onclick="closeTaskModal()">&times;</button>
            </div>
            <form id="task-form">
                <div class="form-group">
                    <label class="form-label">Title</label>
                    <input type="text" class="form-input" id="task-title" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Description</label>
                    <textarea class="form-textarea" id="task-description"></textarea>
                </div>
                <div class="form-group">
                    <label class="form-label">Priority</label>
                    <select class="form-select" id="task-priority">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Assigned To</label>
                    <select class="form-select" id="task-assignee">
                        <option value="John Doe">John Doe</option>
                        <option value="Jane Smith">Jane Smith</option>
                        <option value="Mike Johnson">Mike Johnson</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Due Date</label>
                    <input type="date" class="form-input" id="task-due-date">
                </div>
                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeTaskModal()">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="submit-btn">Add Task</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Application State
        let tasks = [];
        let currentUser = 'John Doe';
        let editingTaskId = null;
        let draggedTask = null;

        // Users
        const users = ['John Doe', 'Jane Smith', 'Mike Johnson'];

        // Initialize the application
        function init() {
            loadTasks();
            setupEventListeners();
            renderTasks();
            updateDashboard();
            setupStorageListener();
        }

        // Load tasks from localStorage
        function loadTasks() {
            const savedTasks = localStorage.getItem('taskflow-tasks');
            if (savedTasks) {
                tasks = JSON.parse(savedTasks);
            } else {
                // Create sample tasks
                tasks = [
                    {
                        id: 1,
                        title: 'Design homepage wireframes',
                        description: 'Create wireframes for the new homepage layout',
                        priority: 'high',
                        assignee: 'John Doe',
                        dueDate: '2025-07-20',
                        status: 'todo',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 2,
                        title: 'Implement user authentication',
                        description: 'Set up login and registration system',
                        priority: 'medium',
                        assignee: 'Jane Smith',
                        dueDate: '2025-07-25',
                        status: 'inprogress',
                        createdAt: new Date().toISOString()
                    },
                    {
                        id: 3,
                        title: 'Write API documentation',
                        description: 'Document all API endpoints',
                        priority: 'low',
                        assignee: 'Mike Johnson',
                        dueDate: '2025-07-30',
                        status: 'done',
                        createdAt: new Date().toISOString()
                    }
                ];
                saveTasks();
            }
        }

        // Save tasks to localStorage
        function saveTasks() {
            localStorage.setItem('taskflow-tasks', JSON.stringify(tasks));
            // Trigger storage event for real-time updates
            window.dispatchEvent(new Event('storage'));
        }

        // Setup event listeners
        function setupEventListeners() {
            // Form submission
            document.getElementById('task-form').addEventListener('submit', handleTaskSubmit);

            // Drag and drop
            setupDragAndDrop();

            // Close modal on outside click
            document.getElementById('task-modal').addEventListener('click', function(e) {
                if (e.target === this) {
                    closeTaskModal();
                }
            });
        }

        // Setup storage listener for real-time updates
        function setupStorageListener() {
            window.addEventListener('storage', function(e) {
                if (e.key === 'taskflow-tasks') {
                    loadTasks();
                    renderTasks();
                    updateDashboard();
                }
            });
        }

        // Setup drag and drop functionality
        function setupDragAndDrop() {
            const containers = document.querySelectorAll('.tasks-container');
            
            containers.forEach(container => {
                container.addEventListener('dragover', handleDragOver);
                container.addEventListener('drop', handleDrop);
                container.addEventListener('dragenter', handleDragEnter);
                container.addEventListener('dragleave', handleDragLeave);
            });
        }

        // Drag and drop handlers
        function handleDragStart(e) {
            draggedTask = e.target;
            e.target.classList.add('dragging');
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/html', e.target.outerHTML);
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
            draggedTask = null;
        }

        function handleDragOver(e) {
            e.preventDefault();
            e.dataTransfer.dropEffect = 'move';
        }

        function handleDragEnter(e) {
            e.preventDefault();
            e.target.classList.add('drag-over');
        }

        function handleDragLeave(e) {
            e.target.classList.remove('drag-over');
        }

        function handleDrop(e) {
            e.preventDefault();
            e.target.classList.remove('drag-over');
            
            if (draggedTask) {
                const taskId = parseInt(draggedTask.dataset.taskId);
                const newStatus = e.target.closest('.column').dataset.status;
                
                // Update task status
                const taskIndex = tasks.findIndex(t => t.id === taskId);
                if (taskIndex !== -1) {
                    tasks[taskIndex].status = newStatus;
                    saveTasks();
                    renderTasks();
                    updateDashboard();
                }
            }
        }

        // Task management functions
        function openTaskModal(taskId = null) {
            const modal = document.getElementById('task-modal');
            const form = document.getElementById('task-form');
            const title = document.getElementById('modal-title');
            const submitBtn = document.getElementById('submit-btn');
            
            if (taskId) {
                // Edit mode
                const task = tasks.find(t => t.id === taskId);
                if (task) {
                    editingTaskId = taskId;
                    title.textContent = 'Edit Task';
                    submitBtn.textContent = 'Update Task';
                    
                    // Fill form with task data
                    document.getElementById('task-title').value = task.title;
                    document.getElementById('task-description').value = task.description;
                    document.getElementById('task-priority').value = task.priority;
                    document.getElementById('task-assignee').value = task.assignee;
                    document.getElementById('task-due-date').value = task.dueDate;
                }
            } else {
                // Add mode
                editingTaskId = null;
                title.textContent = 'Add New Task';
                submitBtn.textContent = 'Add Task';
                form.reset();
                document.getElementById('task-assignee').value = currentUser;
            }
            
            modal.classList.add('active');
        }

        function closeTaskModal() {
            document.getElementById('task-modal').classList.remove('active');
            document.getElementById('task-form').reset();
            editingTaskId = null;
        }

        function handleTaskSubmit(e) {
            e.preventDefault();
            
            const formData = {
                title: document.getElementById('task-title').value,
                description: document.getElementById('task-description').value,
                priority: document.getElementById('task-priority').value,
                assignee: document.getElementById('task-assignee').value,
                dueDate: document.getElementById('task-due-date').value
            };
            
            if (editingTaskId) {
                // Update existing task
                const taskIndex = tasks.findIndex(t => t.id === editingTaskId);
                if (taskIndex !== -1) {
                    tasks[taskIndex] = { ...tasks[taskIndex], ...formData };
                }
            } else {
                // Create new task
                const newTask = {
                    id: Date.now(),
                    ...formData,
                    status: 'todo',
                    createdAt: new Date().toISOString()
                };
                tasks.push(newTask);
            }
            
            saveTasks();
            renderTasks();
            updateDashboard();
            closeTaskModal();
        }

        function deleteTask(taskId) {
            if (confirm('Are you sure you want to delete this task?')) {
                tasks = tasks.filter(t => t.id !== taskId);
                saveTasks();
                renderTasks();
                updateDashboard();
            }
        }

        // Render tasks
        function renderTasks() {
            const filteredTasks = getFilteredTasks();
            const todoContainer = document.getElementById('todo-tasks');
            const inprogressContainer = document.getElementById('inprogress-tasks');
            const doneContainer = document.getElementById('done-tasks');
            
            // Clear containers
            todoContainer.innerHTML = '';
            inprogressContainer.innerHTML = '';
            doneContainer.innerHTML = '';
            
            // Group tasks by status
            const todoTasks = filteredTasks.filter(t => t.status === 'todo');
            const inprogressTasks = filteredTasks.filter(t => t.status === 'inprogress');
            const doneTasks = filteredTasks.filter(t => t.status === 'done');
            
            // Render each group
            todoTasks.forEach(task => todoContainer.appendChild(createTaskElement(task)));
            inprogressTasks.forEach(task => inprogressContainer.appendChild(createTaskElement(task)));
            doneTasks.forEach(task => doneContainer.appendChild(createTaskElement(task)));
            
            // Update counts
            document.getElementById('todo-count').textContent = todoTasks.length;
            document.getElementById('inprogress-count').textContent = inprogressTasks.length;
            document.getElementById('done-count').textContent = doneTasks.length;
        }

        function createTaskElement(task) {
            const taskElement = document.createElement('div');
            taskElement.className = 'task';
            taskElement.draggable = true;
            taskElement.dataset.taskId = task.id;
            
            // Add event listeners
            taskElement.addEventListener('dragstart', handleDragStart);
            taskElement.addEventListener('dragend', handleDragEnd);
            
            const dueDate = task.dueDate ? new Date(task.dueDate).toLocaleDateString() : 'No due date';
            
            taskElement.innerHTML = `
                <div class="task-header">
                    <div class="task-title">${task.title}</div>
                    <div class="task-actions">
                        <button class="task-action" onclick="openTaskModal(${task.id})" title="Edit">✏️</button>
                        <button class="task-action" onclick="deleteTask(${task.id})" title="Delete">🗑️</button>
                    </div>
                </div>
                <div class="task-description">${task.description}</div>
                <div class="task-meta">
                    <span class="task-priority priority-${task.priority}">${task.priority}</span>
                    <span>Due: ${dueDate}</span>
                </div>
                <div class="task-meta">
                    <span>Assigned: ${task.assignee}</span>
                </div>
            `;
            
            return taskElement;
        }

        // Filter tasks
        function getFilteredTasks() {
            const userFilter = document.getElementById('user-filter').value;
            const priorityFilter = document.getElementById('priority-filter').value;
            
            return tasks.filter(task => {
                const userMatch = !userFilter || task.assignee === userFilter;
                const priorityMatch = !priorityFilter || task.priority === priorityFilter;
                return userMatch && priorityMatch;
            });
        }

        function filterTasks() {
            renderTasks();
            updateDashboard();
        }

        // User switching
        function switchUser() {
            const currentIndex = users.indexOf(currentUser);
            const nextIndex = (currentIndex + 1) % users.length;
            currentUser = users[nextIndex];
            document.getElementById('current-user').textContent = currentUser;
        }

        // Theme toggle
        function toggleTheme() {
            const body = document.body;
            const currentTheme = body.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            body.setAttribute('data-theme', newTheme);
            localStorage.setItem('taskflow-theme', newTheme);
            
            // Update theme toggle button
            const themeToggle = document.querySelector('.theme-toggle');
            themeToggle.textContent = newTheme === 'dark' ? '☀️' : '🌙';
        }

        // Load theme on startup
        function loadTheme() {
            const savedTheme = localStorage.getItem('taskflow-theme');
            if (savedTheme) {
                document.body.setAttribute('data-theme', savedTheme);
                const themeToggle = document.querySelector('.theme-toggle');
                themeToggle.textContent = savedTheme === 'dark' ? '☀️' : '🌙';
            }
        }

        // Tab switching
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName + '-tab').classList.add('active');
            
            if (tabName === 'dashboard') {
                updateDashboard();
            }
        }

        // Dashboard functions
        function updateDashboard() {
            updateStats();
            drawTaskChart();
            drawUserChart();
        }

        function updateStats() {
            const totalTasks = tasks.length;
            const completedTasks = tasks.filter(t => t.status === 'done').length;
            const inProgressTasks = tasks.filter(t => t.status === 'inprogress').length;
            const completionRate = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
            
            document.getElementById('total-tasks').textContent = totalTasks;
            document.getElementById('completed-tasks').textContent = completedTasks;
            document.getElementById('in-progress-tasks').textContent = inProgressTasks;
            document.getElementById('completion-rate').textContent = completionRate + '%';
        }

        function drawTaskChart() {
            const canvas = document.getElementById('task-chart');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Data
            const todoCount = tasks.filter(t => t.status === 'todo').length;
            const inprogressCount = tasks.filter(t => t.status === 'inprogress').length;
            const doneCount = tasks.filter(t => t.status === 'done').length;
            
            const data = [
                { label: 'To Do', value: todoCount, color: '#ef4444' },
                { label: 'In Progress', value: inprogressCount, color: '#f59e0b' },
                { label: 'Done', value: doneCount, color: '#10b981' }
            ];
            
            // Chart dimensions
            const centerX = canvas.width / 2;
            const centerY = canvas.height / 2;
            const radius = Math.min(centerX, centerY) - 40;
            
            // Calculate angles
            const total = data.reduce((sum, item) => sum + item.value, 0);
            let currentAngle = -Math.PI / 2;
            
            // Draw pie chart
            data.forEach(item => {
                if (item.value > 0) {
                    const sliceAngle = (item.value / total) * 2 * Math.PI;
                    
                    // Draw slice
                    ctx.beginPath();
                    ctx.moveTo(centerX, centerY);
                    ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                    ctx.closePath();
                    ctx.fillStyle = item.color;
                    ctx.fill();
                    
                    // Draw label
                    const labelAngle = currentAngle + sliceAngle / 2;
                    const labelX = centerX + Math.cos(labelAngle) * (radius + 20);
                    const labelY = centerY + Math.sin(labelAngle) * (radius + 20);
                    
                    ctx.fillStyle = '#374151';
                    ctx.font = '12px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(item.label, labelX, labelY);
                    ctx.fillText(item.value, labelX, labelY + 15);
                    
                    currentAngle += sliceAngle;
                }
            });
            
            // Draw center circle for donut effect
            ctx.beginPath();
            ctx.arc(centerX, centerY, radius * 0.4, 0, 2 * Math.PI);
            ctx.fillStyle = getComputedStyle(document.body).getPropertyValue('--surface-color');
            ctx.fill();
        }

        function drawUserChart() {
            const canvas = document.getElementById('user-chart');
            const ctx = canvas.getContext('2d');
            
            // Clear canvas
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Data
            const userTaskCounts = {};
            users.forEach(user => {
                userTaskCounts[user] = tasks.filter(t => t.assignee === user).length;
            });
            
            const maxCount = Math.max(...Object.values(userTaskCounts));
            const barWidth = canvas.width / users.length * 0.8;
            const barSpacing = canvas.width / users.length * 0.2;
            
            // Draw bars
            users.forEach((user, index) => {
                const count = userTaskCounts[user];
                const barHeight = (count / maxCount) * (canvas.height - 60);
                const x = index * (barWidth + barSpacing) + barSpacing / 2;
                const y = canvas.height - barHeight - 30;
                
                // Draw bar
                ctx.fillStyle = '#3b82f6';
                ctx.fillRect(x, y, barWidth, barHeight);
                
                // Draw label
                ctx.fillStyle = '#374151';
                ctx.font = '12px Arial';
                ctx.textAlign = 'center';
                ctx.fillText(user, x + barWidth / 2, canvas.height - 10);
                
                // Draw count
                ctx.fillText(count, x + barWidth / 2, y - 5);
            });
        }

        // Initialize application when DOM is loaded
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();
            init();
        });
    </script>
</body>
</html>